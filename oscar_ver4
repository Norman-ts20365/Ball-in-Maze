#!/usr/bin/env python

from collections import deque
import numpy as np
import cv2
import imutils
import matplotlib.pyplot as plt
import time,os
import serial
import sys
from datetime import datetime
from time import strftime
from time import sleep
from multiprocessing import Process
from random import randint

# Packet declaration
easy_route = [[341, 22], [340, 22], [339, 22], [338, 22], [337, 22], [336, 23], [335, 23], [334, 23], [333, 23], [332, 23], [331, 23], [330, 23], [329, 23], [328, 23], [327, 23], [326, 23], [325, 23], [324, 23], [323, 23], [322, 23], [321, 22], [320, 22], [319, 22], [318, 22], [317, 22], [316, 22], [315, 22], [314, 22], [313, 22], [312, 22], [311, 23], [310, 23], [309, 23], [308, 23], [307, 23], [306, 23], [305, 23], [304, 22], [303, 22], [302, 22], [301, 22], [300, 22], [299, 22], [298, 22], [297, 23], [296, 23], [295, 23], [294, 23], [293, 23], [292, 23], [291, 23], [290, 23], [289, 23], [288, 23], [287, 23], [286, 23], [285, 23], [284, 23], [283, 23], [282, 23], [281, 23], [280, 23], [279, 23], [278, 23], [277, 23], [276, 23], [275, 23], [274, 23], [273, 23], [272, 23], [271, 23], [270, 23], [269, 23], [268, 23], [267, 23], [266, 23], [265, 23], [264, 23], [263, 23], [262, 23], [261, 23], [260, 23], [259, 23], [258, 23], [257, 23], [256, 23], [255, 23], [254, 23], [253, 23], [252, 23], [251, 24], [250, 24], [249, 24], [248, 24], [247, 24], [246, 24], [245, 24], [244, 24], [243, 24], [242, 24], [241, 24], [240, 24], [239, 24], [238, 24], [237, 24], [236, 24], [235, 23], [234, 23], [233, 23], [232, 23], [231, 24], [230, 24], [229, 24], [228, 24], [227, 24], [226, 24], [225, 24], [224, 24], [223, 24], [222, 24], [221, 24], [220, 24], [219, 24], [218, 24], [217, 24], [216, 24], [215, 24], [214, 24], [213, 24], [212, 24], [211, 24], [210, 24], [209, 24], [208, 24], [207, 24], [206, 24], [205, 24], [204, 24], [203, 24], [202, 23], [201, 23], [200, 23], [199, 23], [198, 23], [197, 23], [196, 23], [195, 23], [194, 23], [193, 24], [192, 24], [191, 24], [190, 24], [189, 24], [188, 24], [187, 24], [186, 24], [185, 24], [184, 24], [183, 24], [182, 24], [181, 24], [180, 24], [179, 24], [178, 23], [177, 23], [176, 23], [175, 23], [174, 23], [173, 23], [172, 23], [171, 23], [170, 23], [169, 23], [168, 23], [167, 23], [166, 23], [165, 23], [164, 23], [163, 24], [162, 24], [161, 24], [160, 24], [159, 24], [158, 24], [157, 24], [156, 24], [155, 23], [154, 23], [153, 24], [152, 24], [151, 24], [150, 24], [149, 24], [148, 24], [147, 24], [146, 24], [145, 24], [144, 24], [143, 24], [142, 24], [141, 24], [140, 24], [139, 24], [138, 24], [137, 24], [136, 24], [135, 24], [134, 24], [133, 24], [132, 24], [131, 24], [130, 23], [129, 24], [128, 24], [127, 24], [126, 24], [125, 24], [124, 24], [123, 24], [122, 24], [121, 24], [120, 24], [119, 24], [118, 24], [117, 24], [116, 24], [115, 25], [114, 25], [113, 25], [112, 25], [111, 25], [110, 25], [109, 26], [108, 27], [107, 27], [106, 27], [105, 27], [104, 27], [103, 28], [102, 29], [101, 29], [100, 30], [99, 31], [98, 31], [97, 31], [96, 32], [95, 33], [94, 34], [93, 34], [92, 35], [91, 36], [90, 36], [89, 37], [88, 37], [87, 38], [86, 39], [85, 40], [84, 40], [83, 41], [82, 42], [81, 43], [80, 44], [79, 44], [78, 45], [77, 46], [76, 47], [75, 47], [74, 48], [73, 49], [72, 50], [71, 51], [70, 52], [69, 53], [68, 54], [67, 55], [66, 56], [65, 57], [64, 58], [63, 59], [62, 60], [61, 61], [60, 62], [59, 63], [58, 64], [58, 65], [57, 66], [56, 67], [55, 68], [54, 69], [53, 70], [52, 71], [51, 72], [51, 73], [50, 74], [49, 75], [49, 76], [48, 77], [47, 78], [46, 79], [46, 80], [45, 81], [44, 82], [44, 83], [44, 84], [43, 85], [43, 86], [42, 87], [41, 88], [41, 89], [41, 90], [40, 91], [40, 92], [39, 93], [39, 94], [38, 95], [38, 96], [37, 97], [37, 98], [37, 99], [36, 100], [36, 101], [36, 102], [36, 103], [35, 104], [35, 105], [35, 106], [35, 107], [34, 108], [34, 109], [34, 110], [34, 111], [34, 112], [33, 113], [33, 114], [33, 115], [33, 116], [33, 117], [33, 118], [33, 119], [33, 120], [33, 121], [33, 122], [33, 123], [33, 124], [33, 125], [33, 126], [33, 127], [33, 128], [32, 129], [32, 130], [32, 131], [32, 132], [32, 133], [33, 134], [33, 135], [33, 136], [32, 137], [32, 138], [32, 139], [32, 140], [32, 141], [33, 142], [33, 143], [33, 144], [33, 145], [32, 146], [32, 147], [32, 148], [32, 149], [32, 150], [32, 151], [32, 152], [32, 153], [32, 154], [32, 155], [32, 156], [32, 157], [32, 158], [32, 159], [32, 160], [32, 161], [32, 162], [32, 163], [32, 164], [32, 165], [32, 166], [32, 167], [32, 168], [32, 169], [32, 170], [32, 171], [32, 172], [32, 173], [32, 174], [32, 175], [32, 176], [32, 177], [32, 178], [32, 179], [32, 180], [32, 181], [32, 182], [32, 183], [32, 184], [32, 185], [32, 186], [32, 187], [32, 188], [32, 189], [32, 190], [32, 191], [32, 192], [32, 193], [32, 194], [32, 195], [32, 196], [32, 197], [32, 198], [32, 199], [33, 200], [33, 201], [33, 202], [34, 203], [34, 204], [34, 205], [34, 206], [35, 207], [35, 208], [35, 209], [36, 210], [36, 211], [37, 212], [37, 213], [37, 214], [38, 215], [38, 216], [39, 217], [40, 218], [41, 219], [41, 220], [42, 221], [43, 222], [43, 223], [44, 224], [45, 225], [46, 226], [47, 227], [48, 228], [49, 229], [50, 230], [51, 231], [52, 231], [53, 232], [54, 233], [55, 233], [56, 234], [57, 234], [58, 235], [59, 236], [60, 236], [61, 236], [62, 237], [63, 237], [64, 237], [65, 238], [66, 238], [67, 238], [68, 238], [69, 239], [70, 239], [71, 239], [72, 239], [73, 239], [74, 239], [75, 239], [76, 239], [77, 239], [78, 239], [79, 239], [80, 239], [81, 239], [82, 238], [83, 238], [84, 238], [85, 238], [86, 237], [87, 237], [88, 237], [89, 236], [90, 236], [91, 236], [92, 235], [93, 234], [94, 234], [95, 233], [96, 233], [97, 232], [98, 231], [99, 231], [100, 230], [101, 229], [102, 229], [103, 228], [104, 227], [105, 226], [106, 225], [107, 225], [108, 224], [109, 223], [110, 223], [111, 222], [112, 222], [113, 221], [114, 221], [115, 220], [116, 220], [117, 219], [118, 219], [119, 219], [120, 218], [121, 218], [122, 217], [123, 217], [124, 217], [125, 216], [126, 216], [127, 216], [128, 215], [129, 215], [130, 215], [131, 215], [132, 214], [133, 214], [134, 214], [135, 213], [136, 213], [137, 213], [138, 213], [139, 213], [140, 213], [141, 212], [142, 212], [143, 212], [144, 212], [145, 212], [146, 212], [147, 212], [148, 211], [149, 211], [150, 211], [151, 211], [152, 211], [153, 211], [154, 211], [155, 211], [156, 211], [157, 211], [158, 211], [159, 211], [160, 210], [161, 210], [162, 210], [163, 210], [164, 210], [165, 210], [166, 210], [167, 210], [168, 210], [169, 210], [170, 210], [171, 210], [172, 210], [173, 210], [174, 210], [175, 210], [176, 210], [177, 210], [178, 210], [179, 211], [180, 211], [181, 211], [182, 211], [183, 211], [184, 211], [185, 211], [186, 211], [187, 212], [188, 212], [189, 212], [190, 212], [191, 212], [192, 212], [193, 213], [194, 213], [195, 213], [196, 213], [197, 214], [198, 214], [199, 214], [200, 214], [201, 215], [202, 215], [203, 215], [204, 215], [205, 216], [206, 216], [207, 216], [208, 217], [209, 217], [210, 217], [211, 218], [212, 218], [213, 218], [214, 219], [215, 219], [216, 220], [217, 220], [218, 220], [219, 221], [220, 221], [221, 221], [222, 222], [223, 222], [224, 223], [225, 223], [226, 224], [227, 224], [228, 225], [229, 225], [230, 226], [231, 226], [232, 227], [233, 228], [234, 228], [235, 229], [236, 229], [237, 230], [238, 231], [239, 231], [240, 232], [241, 233], [242, 233], [243, 234], [244, 235], [245, 235], [246, 236], [247, 237], [248, 238], [249, 238], [250, 239], [251, 240], [252, 241], [253, 242], [254, 243], [255, 243], [256, 244], [257, 245], [258, 246], [259, 247], [260, 248], [261, 249], [262, 250], [263, 251], [264, 252], [265, 253], [265, 254], [266, 255], [267, 256], [268, 257], [269, 258], [269, 259], [270, 260], [271, 261], [271, 262], [272, 263], [272, 264], [273, 265], [273, 266], [274, 267], [275, 268], [275, 269], [276, 270], [276, 271], [277, 272], [277, 273], [278, 274], [278, 275], [279, 276], [279, 277], [279, 278], [280, 279], [280, 280], [281, 281], [281, 282], [281, 283], [282, 284], [282, 285], [282, 286], [282, 287], [283, 288], [283, 289], [283, 290], [283, 291], [284, 292], [284, 293], [284, 294], [284, 295], [284, 296], [284, 297], [284, 298], [284, 299], [285, 300], [285, 301], [285, 302], [285, 303], [285, 304], [285, 305], [285, 306], [285, 307], [285, 308], [285, 309], [285, 310], [285, 311], [285, 312], [285, 313], [285, 314], [285, 315], [285, 316], [285, 317], [285, 318], [284, 319], [284, 320], [284, 321], [284, 322], [284, 323], [283, 324], [283, 325], [283, 326], [282, 327], [282, 328], [282, 329], [281, 330], [281, 331], [280, 332], [280, 333], [279, 334], [278, 335], [278, 336], [277, 337], [276, 338], [276, 339], [275, 340], [274, 341], [273, 342], [273, 343], [272, 344], [271, 345], [270, 346], [269, 347], [268, 348], [267, 349], [266, 350], [265, 351], [264, 352], [263, 352], [262, 353], [261, 354], [260, 354], [259, 355], [258, 356], [257, 357], [256, 357], [255, 358], [254, 358], [253, 359], [252, 360], [251, 360], [250, 361], [249, 361], [248, 362], [247, 362], [246, 363], [245, 363], [244, 363], [243, 364], [242, 364], [241, 365], [240, 365], [239, 365], [238, 366], [237, 366], [236, 366], [235, 367], [234, 367], [233, 367], [232, 367], [231, 368], [230, 368], [229, 368], [228, 369], [227, 369], [226, 369], [225, 369], [224, 369], [223, 370], [222, 370], [221, 370], [220, 370], [219, 370], [218, 370], [217, 371], [216, 371], [215, 371], [214, 371], [213, 371], [212, 371], [211, 371], [210, 371], [209, 371], [208, 371], [207, 371], [206, 372], [205, 372], [204, 372], [203, 372], [202, 372], [201, 372], [200, 372], [199, 371], [198, 371], [197, 371], [196, 371], [195, 371], [194, 371], [193, 371], [192, 371], [191, 371], [190, 371], [189, 371], [188, 371], [187, 370], [186, 370], [185, 370], [184, 370], [183, 370], [182, 370], [181, 369], [180, 369], [179, 369], [178, 369], [177, 369], [176, 368], [175, 368], [174, 368], [173, 368], [172, 368], [171, 367], [170, 367], [169, 367], [168, 367], [167, 366], [166, 366], [165, 366], [164, 365], [163, 365], [162, 365], [161, 365], [160, 364], [159, 364], [158, 364], [157, 363], [156, 363], [155, 362], [154, 362], [153, 362], [152, 361], [151, 361], [150, 361], [149, 360], [148, 360], [147, 360], [146, 360], [145, 360], [144, 360], [143, 360], [142, 360], [141, 360], [140, 360], [139, 359], [138, 360], [137, 360], [136, 360], [135, 360], [134, 360], [133, 360], [132, 360], [131, 360], [130, 360], [129, 360], [128, 360], [127, 361], [126, 361], [125, 361], [124, 361], [123, 361], [122, 362], [121, 362], [120, 362], [119, 363], [118, 363], [117, 363], [116, 364], [115, 364], [114, 365], [113, 365], [112, 366], [111, 366], [110, 367], [109, 367], [108, 368], [107, 368], [106, 369], [105, 370], [104, 370], [103, 371], [102, 372], [101, 373], [100, 374], [99, 374], [98, 375], [97, 376], [96, 377], [95, 378], [94, 379], [93, 380], [92, 381], [91, 382], [90, 383], [89, 384], [88, 385], [88, 386], [87, 387], [86, 388], [86, 389], [85, 390], [85, 391], [84, 392], [84, 393], [83, 394], [83, 395], [82, 396], [82, 397], [81, 398], [80, 399], [80, 400], [79, 401], [79, 402], [78, 403], [78, 404], [77, 405], [77, 406], [76, 407], [76, 408], [75, 409], [75, 410], [74, 411], [74, 412], [73, 413], [73, 414], [72, 415], [71, 416], [71, 417], [70, 418], [70, 419], [69, 420], [69, 421], [68, 422], [68, 423], [67, 424], [67, 425], [66, 426], [66, 427], [65, 428], [65, 429], [64, 430], [64, 431], [63, 432], [62, 433], [62, 434], [61, 435], [61, 436], [60, 437], [60, 438], [59, 439], [59, 440], [58, 441], [58, 442], [57, 443], [57, 444], [56, 445], [56, 446], [55, 447], [55, 448], [54, 449], [54, 450], [53, 451], [53, 452], [52, 453], [51, 454], [51, 455], [50, 456], [50, 457], [49, 458], [49, 459], [48, 460], [48, 461], [47, 462], [47, 463], [46, 464], [46, 465], [45, 466], [45, 467], [44, 468], [43, 469], [43, 470], [42, 471], [42, 472], [41, 473], [41, 474], [40, 475], [40, 476], [39, 477], [39, 478], [39, 479], [38, 480], [38, 481], [38, 482], [38, 483], [38, 484], [37, 485], [37, 486], [37, 487], [37, 488], [37, 489], [36, 490], [36, 491], [36, 492], [36, 493], [36, 494], [36, 495], [35, 496], [35, 497], [35, 498], [35, 499], [35, 500], [35, 501], [35, 502], [35, 503], [35, 504], [35, 505], [35, 506], [35, 507], [35, 508], [35, 509], [35, 510], [35, 511], [35, 512], [35, 513], [35, 514], [35, 515], [35, 516], [35, 517], [35, 518], [35, 519], [35, 520], [35, 521], [35, 522], [35, 523], [35, 524], [35, 525], [35, 526], [35, 527], [35, 528], [35, 529], [35, 530], [35, 531], [35, 532], [36, 533], [36, 534], [36, 535], [36, 536], [37, 537], [37, 538], [38, 539], [38, 540], [38, 541], [39, 542], [39, 543], [40, 544], [41, 545], [41, 546], [42, 547], [43, 548], [43, 549], [44, 550], [45, 550], [46, 551], [47, 552], [48, 552], [49, 553], [50, 554], [51, 554], [52, 555], [53, 555], [54, 555], [55, 555], [56, 555], [57, 555], [58, 555], [59, 555], [60, 555], [61, 555], [62, 555], [63, 555], [64, 555], [65, 555], [66, 555], [67, 555], [68, 555], [69, 555], [70, 555], [71, 555], [72, 555], [73, 555], [74, 555], [75, 555], [76, 555], [77, 555], [78, 555], [79, 555], [80, 555], [81, 555], [82, 555], [83, 555], [84, 555], [85, 555], [86, 555], [87, 555], [88, 555], [89, 555], [90, 555], [91, 555], [92, 554], [93, 554], [94, 554], [95, 554], [96, 554], [97, 554], [98, 554], [99, 554], [100, 554], [101, 554], [102, 554], [103, 554], [104, 554], [105, 554], [106, 554], [107, 554], [108, 554], [109, 554], [110, 554], [111, 554], [112, 554], [113, 554], [114, 554], [115, 554], [116, 554], [117, 554], [118, 554], [119, 554], [120, 554], [121, 554], [122, 554], [123, 554], [124, 554], [125, 554], [126, 554], [127, 554], [128, 554], [129, 554], [130, 554], [131, 554], [132, 554], [133, 554], [134, 554], [135, 554], [136, 554], [137, 554], [138, 553], [139, 553], [140, 553], [141, 553], [142, 553], [143, 553], [144, 553], [145, 553], [146, 553], [147, 553], [148, 553], [149, 553], [150, 553], [151, 553], [152, 553], [153, 553], [154, 553], [155, 553], [156, 553], [157, 553], [158, 553], [159, 553], [160, 553], [161, 553], [162, 553], [163, 553], [164, 553], [165, 553], [166, 553], [167, 553], [168, 553], [169, 553], [170, 552], [171, 551], [172, 550], [173, 549], [174, 548], [175, 547], [175, 546], [175, 545], [175, 544], [175, 543], [175, 542], [175, 541], [175, 540], [175, 539], [175, 538], [175, 537], [175, 536], [175, 535], [175, 534], [175, 533], [175, 532], [174, 531], [174, 530], [174, 529], [174, 528], [174, 527], [174, 526], [174, 525], [174, 524], [174, 523], [175, 522], [174, 521], [174, 520], [174, 519], [174, 518], [174, 517], [174, 516], [174, 515], [174, 514], [174, 513], [175, 512], [175, 511], [175, 510], [174, 509], [174, 508], [174, 507], [174, 506], [174, 505], [174, 504], [174, 503], [174, 502], [174, 501], [174, 500], [174, 499], [174, 498], [174, 497], [174, 496], [175, 495], [174, 494], [174, 493], [174, 492], [174, 491], [174, 490], [174, 489], [174, 488], [174, 487], [174, 486], [174, 485], [174, 484], [174, 483], [174, 482], [174, 481], [174, 480], [174, 479], [174, 478], [174, 477], [175, 476], [175, 475], [175, 474], [176, 473], [176, 472], [177, 471], [178, 470], [179, 470], [180, 469], [181, 469], [182, 469], [183, 469], [184, 469], [185, 469], [186, 469], [187, 469], [188, 469], [189, 469], [190, 469], [191, 469], [192, 469], [193, 469], [194, 469], [195, 469], [196, 469], [197, 469], [198, 469], [199, 469], [200, 469], [201, 469], [202, 469], [203, 469], [204, 469], [205, 469], [206, 469], [207, 469], [208, 469], [209, 469], [210, 469], [211, 469], [212, 469], [213, 469], [214, 469], [215, 469], [216, 469], [217, 469], [218, 469], [219, 469], [220, 469], [221, 469], [222, 469], [223, 469], [224, 469], [225, 469], [226, 469], [227, 469], [228, 469], [229, 469], [230, 469], [231, 469], [232, 469], [233, 469], [234, 469], [235, 469], [236, 469], [237, 469], [238, 469], [239, 469], [240, 469], [241, 469], [242, 469], [243, 468], [244, 469], [245, 469], [246, 470], [247, 471], [248, 472], [249, 473], [249, 474], [250, 475], [250, 476], [250, 477], [250, 478], [250, 479], [250, 480], [250, 481], [250, 482], [250, 483], [250, 484], [250, 485], [250, 486], [250, 487], [250, 488], [250, 489], [250, 490], [250, 491], [250, 492], [250, 493], [250, 494], [250, 495], [250, 496], [250, 497], [250, 498], [250, 499], [250, 500], [250, 501], [250, 502], [250, 503], [250, 504], [250, 505], [250, 506], [250, 507], [250, 508], [250, 509], [250, 510], [250, 511], [250, 512], [250, 513], [250, 514], [250, 515], [250, 516], [250, 517], [250, 518], [250, 519], [250, 520], [250, 521], [250, 522], [250, 523], [250, 524], [250, 525], [250, 526], [250, 527], [251, 528], [252, 529], [253, 530], [254, 531], [255, 532], [256, 532], [257, 532], [258, 532], [259, 532], [260, 532], [261, 532], [262, 532], [263, 532], [264, 532], [265, 532], [266, 532], [267, 532], [268, 532], [269, 532], [270, 532], [271, 532], [272, 532], [273, 532], [274, 532], [275, 532], [276, 532], [277, 532], [278, 532], [279, 532], [280, 532], [281, 532], [282, 532], [283, 532], [284, 532], [285, 532], [286, 532], [287, 532], [288, 532], [289, 532], [290, 532], [291, 532], [292, 532], [293, 532], [294, 532], [295, 532], [296, 532], [297, 532], [298, 532], [299, 532], [300, 532], [301, 532], [302, 532], [303, 532], [304, 532], [305, 532], [306, 532], [307, 532], [308, 532], [309, 532], [310, 532], [311, 532], [312, 532], [313, 532], [314, 532], [315, 532], [316, 532], [317, 532], [318, 532], [319, 532], [320, 532], [321, 532], [322, 532], [323, 532], [324, 532], [325, 532], [326, 532], [327, 532], [328, 532], [329, 532], [330, 532], [331, 531], [332, 530], [333, 530], [334, 529], [335, 528], [335, 527], [336, 526], [337, 525], [337, 524], [337, 523], [337, 522], [337, 521], [337, 520], [336, 519], [336, 518], [336, 517], [336, 516], [336, 515], [337, 514], [336, 513], [336, 512], [336, 511], [336, 510], [336, 509], [336, 508], [336, 507], [336, 506], [336, 505], [336, 504], [336, 503], [336, 502], [337, 501], [337, 500], [336, 499], [336, 498], [336, 497], [336, 496], [336, 495], [336, 494], [336, 493], [336, 492], [336, 491], [336, 490], [336, 489], [337, 488], [337, 487], [336, 486], [336, 485], [336, 484], [336, 483], [336, 482], [336, 481], [336, 480], [336, 479], [336, 478], [336, 477], [336, 476], [336, 475], [337, 474], [337, 473], [337, 472], [338, 471], [339, 470], [340, 469], [341, 468], [342, 468], [343, 468], [344, 468], [345, 468], [346, 468], [347, 468], [348, 468], [349, 468], [350, 468], [351, 468], [352, 468], [353, 468], [354, 468], [355, 468], [356, 468], [357, 468], [358, 468], [359, 468], [360, 468], [361, 468], [362, 468], [363, 468], [364, 468], [365, 468], [366, 468], [367, 468], [368, 468], [369, 468], [370, 468], [371, 468], [372, 468], [373, 468], [374, 468], [375, 468], [376, 468], [377, 468], [378, 468], [379, 468], [380, 468], [381, 468], [382, 468], [383, 468], [384, 468], [385, 468], [386, 468], [387, 468], [388, 468], [389, 468], [390, 468], [391, 468], [392, 468], [393, 468], [394, 468], [395, 468], [396, 468], [397, 468], [398, 468], [399, 468], [400, 468], [401, 468], [402, 468], [403, 468], [404, 468], [405, 468], [406, 468], [407, 468], [408, 468], [409, 468], [410, 468], [411, 468], [412, 468], [413, 468], [414, 468], [415, 468], [416, 468], [417, 468], [418, 468], [419, 468], [420, 468], [421, 468], [422, 468], [423, 468], [424, 468], [425, 468], [426, 468], [427, 468], [428, 468], [429, 468], [430, 468], [431, 468], [432, 468], [433, 468], [434, 468], [435, 468], [436, 468], [437, 468], [438, 468], [439, 468], [440, 468], [441, 468], [442, 468], [443, 468], [444, 468], [445, 468], [446, 468], [447, 468], [448, 468], [449, 468], [450, 468], [451, 468], [452, 468], [453, 468], [454, 468], [455, 468], [456, 468], [457, 468], [458, 468], [459, 468], [460, 468], [461, 467], [462, 467], [463, 467], [464, 466], [465, 466], [466, 466], [467, 465], [468, 465], [469, 464], [470, 463], [471, 463], [472, 462], [473, 461], [474, 460], [475, 459], [475, 458], [476, 457], [477, 456], [477, 455], [477, 454], [478, 453], [477, 452], [477, 451], [477, 450], [477, 449], [477, 448], [477, 447], [477, 446], [477, 445], [477, 444], [477, 443], [477, 442], [477, 441], [477, 440], [477, 439], [477, 438], [477, 437], [477, 436], [477, 435], [477, 434], [477, 433], [477, 432], [477, 431], [477, 430], [477, 429], [477, 428], [477, 427], [477, 426], [477, 425], [477, 424], [477, 423], [477, 422], [477, 421], [477, 420], [477, 419], [477, 418], [477, 417], [477, 416], [477, 415], [477, 414], [477, 413], [477, 412], [477, 411], [477, 410], [477, 409], [477, 408], [477, 407], [477, 406], [477, 405], [477, 404], [477, 403], [477, 402], [477, 401], [477, 400], [477, 399], [477, 398], [477, 397], [477, 396], [477, 395], [477, 394], [477, 393], [477, 392], [477, 391], [476, 390], [475, 389], [475, 388], [474, 387], [474, 386], [473, 385], [472, 384], [471, 383], [470, 382], [469, 381], [468, 380], [467, 380], [466, 379], [465, 379], [464, 378], [463, 378], [462, 378], [461, 377], [460, 377], [459, 377], [458, 377], [457, 376], [456, 376], [455, 376], [454, 376], [453, 376], [452, 376], [451, 376], [450, 376], [449, 376], [448, 376], [447, 376], [446, 376], [445, 376], [444, 376], [443, 376], [442, 376], [441, 376], [440, 376], [439, 376], [438, 376], [437, 376], [436, 376], [435, 376], [434, 376], [433, 376], [432, 376], [431, 376], [430, 376], [429, 376], [428, 376], [427, 376], [426, 376], [425, 376], [424, 376], [423, 376], [422, 376], [421, 376], [420, 376], [419, 376], [418, 376], [417, 376], [416, 376], [415, 376], [414, 376], [413, 376], [412, 376], [411, 376], [410, 376], [409, 376], [408, 376], [407, 376], [406, 376], [405, 376], [404, 376], [403, 376], [402, 376], [401, 376], [400, 376], [399, 376], [398, 376], [397, 376], [396, 376], [395, 376], [394, 376], [393, 376], [392, 376], [391, 376], [390, 375], [389, 375], [388, 375], [387, 374], [386, 374], [385, 373], [384, 373], [383, 372], [382, 372], [381, 371], [380, 371], [379, 370], [378, 369], [377, 369], [376, 368], [375, 367], [374, 366], [373, 365], [372, 364], [371, 363], [370, 362], [370, 361], [369, 360], [368, 359], [367, 358], [367, 357], [367, 356], [366, 355], [366, 354], [365, 353], [365, 352], [364, 351], [364, 350], [364, 349], [363, 348], [363, 347], [363, 346], [362, 345], [362, 344], [362, 343], [362, 342], [361, 341], [361, 340], [361, 339], [361, 338], [361, 337], [361, 336], [361, 335], [361, 334], [360, 333], [360, 332], [360, 331], [360, 330], [360, 329], [360, 328], [360, 327], [360, 326], [360, 325], [360, 324], [360, 323], [360, 322], [361, 321], [361, 320], [361, 319], [361, 318], [361, 317], [362, 316], [362, 315], [362, 314], [362, 313], [363, 312], [363, 311], [364, 310], [364, 309], [364, 308], [365, 307], [365, 306], [366, 305], [366, 304], [366, 303], [367, 302], [368, 301], [368, 300], [369, 299], [369, 298], [370, 297], [371, 296], [372, 295], [373, 294], [374, 293], [375, 292], [376, 291], [377, 290], [378, 289], [379, 288], [380, 287], [381, 286], [382, 285], [383, 284], [384, 284], [385, 283], [386, 283], [387, 282], [388, 282], [389, 281], [390, 281], [391, 280], [392, 280], [393, 279], [394, 279], [395, 278], [396, 278], [397, 277], [398, 277], [399, 276], [400, 276], [401, 275], [402, 275], [403, 274], [404, 274], [405, 273], [406, 273], [407, 272], [408, 272], [409, 271], [410, 271], [411, 270], [412, 270], [413, 269], [414, 269], [415, 268], [416, 268], [417, 267], [418, 267], [419, 266], [420, 266], [421, 265], [422, 265], [423, 264], [424, 264], [425, 263], [426, 263], [427, 262], [428, 262], [429, 261], [430, 261], [431, 260], [432, 259], [433, 259], [434, 259], [435, 258], [436, 257], [437, 257], [438, 256], [439, 256], [440, 255], [441, 255], [442, 254], [443, 254], [444, 253], [445, 253], [446, 252], [447, 252], [448, 251], [449, 251], [450, 250], [451, 250], [452, 249], [453, 249], [454, 248], [455, 248], [456, 247], [457, 247], [458, 246], [459, 246], [460, 245], [461, 245], [462, 244], [463, 244], [464, 243], [465, 243], [466, 242], [467, 242], [468, 241], [469, 241], [470, 240], [471, 240], [472, 239], [473, 239], [474, 238], [475, 238], [476, 237], [477, 237], [478, 236], [479, 236], [480, 235], [481, 235], [482, 234], [483, 234], [484, 233], [485, 233], [486, 232], [487, 232], [488, 231], [489, 231], [490, 230], [491, 230], [492, 229], [493, 229], [494, 228], [495, 228], [496, 227], [497, 227], [498, 226], [499, 225], [500, 225], [501, 225], [502, 224], [503, 224], [504, 223], [505, 222], [506, 222], [507, 221], [508, 221], [509, 221], [510, 220], [511, 219], [512, 219], [513, 218], [514, 218], [515, 218], [516, 217], [517, 216], [518, 216], [519, 215], [520, 215], [521, 214], [522, 214], [523, 213], [524, 213], [525, 212], [526, 212], [527, 211], [528, 211], [529, 210], [530, 209], [531, 209], [532, 208], [533, 207], [534, 207], [535, 206], [536, 205], [537, 204], [538, 203], [539, 203], [540, 202], [541, 201], [542, 200], [542, 199], [543, 198], [544, 197], [544, 196], [545, 195], [546, 194], [547, 193], [547, 192], [548, 191], [549, 190], [550, 189], [550, 188], [551, 187], [551, 186], [552, 185], [552, 184], [553, 183], [553, 182], [553, 181], [554, 180], [554, 179], [554, 178], [555, 177], [555, 176], [555, 175], [555, 174], [555, 173], [555, 172], [556, 171], [556, 170], [556, 169], [556, 168], [556, 167], [556, 166], [556, 165], [556, 164], [556, 163], [556, 162], [556, 161], [556, 160], [556, 159], [556, 158], [556, 157], [556, 156], [556, 155], [556, 154], [556, 153], [556, 152], [556, 151], [556, 150], [556, 149], [556, 148], [556, 147], [556, 146], [556, 145], [555, 144], [555, 143], [555, 142], [555, 141], [555, 140], [555, 139], [554, 138], [554, 137], [554, 136], [554, 135], [553, 134], [553, 133], [552, 132], [552, 131], [552, 130], [551, 129], [551, 128], [550, 127], [550, 126], [550, 125], [549, 124], [549, 123], [548, 122], [548, 121], [547, 120], [547, 119], [546, 118], [546, 117], [545, 116], [544, 115], [544, 114], [543, 113], [542, 112], [542, 111], [541, 110], [540, 109], [539, 108], [538, 107], [538, 106], [537, 105], [536, 104], [535, 103], [534, 102], [533, 101], [532, 100], [531, 99], [530, 99], [529, 98], [528, 97], [527, 96], [526, 95], [525, 94], [524, 94], [523, 93], [522, 92], [521, 92], [520, 91], [519, 91], [518, 90], [517, 89], [516, 89], [515, 88], [514, 87], [513, 86], [512, 85], [511, 84], [510, 83], [509, 82], [508, 81], [507, 80], [506, 79], [505, 78], [504, 77], [504, 76], [503, 75], [503, 74], [502, 73], [501, 72], [501, 71], [501, 70], [500, 69], [500, 68], [500, 67], [500, 66], [499, 65], [499, 64], [499, 63], [499, 62], [499, 61], [499, 60], [499, 59], [499, 58], [499, 57], [499, 56], [499, 55], [500, 54], [500, 53], [500, 52], [501, 51], [501, 50], [501, 49], [501, 48], [501, 47], [502, 46], [502, 45], [503, 44], [503, 43], [504, 42], [504, 41], [505, 40], [506, 39], [507, 38], [508, 37], [509, 36], [510, 35], [511, 34], [512, 33], [513, 32], [514, 32], [515, 31], [516, 30], [517, 30], [518, 30], [519, 30], [520, 30], [521, 29], [522, 29], [523, 28], [524, 28], [525, 28], [526, 28], [527, 28], [528, 28], [529, 28], [530, 28], [531, 28], [532, 28], [533, 28], [534, 28], [535, 28], [536, 28], [537, 28], [538, 28], [539, 28], [540, 28], [541, 28], [542, 28], [543, 28], [544, 28], [545, 28], [546, 28], [547, 28], [548, 28], [549, 28], [550, 28], [551, 28], [552, 28], [553, 28], [554, 28], [555, 28], [556, 28], [557, 28], [558, 28], [559, 28], [560, 28], [561, 28], [562, 28], [563, 28], [564, 28], [565, 27], [566, 27], [567, 27], [568, 28], [569, 28], [570, 28], [571, 28], [572, 28], [573, 28], [574, 28], [575, 28], [576, 27], [577, 27], [578, 28], [579, 28], [580, 28], [581, 28], [582, 28], [583, 28], [584, 28], [585, 28], [586, 28], [587, 28], [588, 28], [589, 28], [590, 28], [591, 28], [592, 28], [593, 28], [594, 27], [595, 27], [596, 27], [597, 27], [598, 27], [599, 27], [600, 27], [601, 27], [602, 27], [603, 27], [604, 27], [605, 27], [606, 27], [607, 27], [608, 27], [609, 27], [610, 27], [611, 27], [612, 27], [613, 28], [614, 28], [615, 28], [616, 28], [617, 29], [618, 30], [619, 31], [620, 32], [621, 33], [622, 34], [623, 35], [624, 36], [625, 37], [626, 38], [626, 39], [627, 40], [628, 41], [629, 42], [630, 43], [631, 44], [631, 45], [632, 46], [633, 47], [634, 48], [635, 49], [636, 50], [637, 51], [638, 52], [639, 53], [640, 54], [641, 55], [642, 56], [643, 57], [644, 58], [645, 59], [646, 59], [647, 60], [648, 61], [649, 62], [650, 62], [651, 63], [652, 64], [653, 64], [654, 65], [655, 66], [656, 66], [657, 67], [658, 67], [659, 68], [660, 69], [661, 69], [662, 70], [663, 70], [664, 71], [665, 71], [666, 72], [667, 72], [668, 72], [669, 73], [670, 73], [671, 73], [672, 73], [673, 74], [674, 74], [675, 74], [676, 75], [677, 75], [678, 75], [679, 76], [680, 76], [681, 77], [682, 77], [683, 78], [684, 79], [685, 79], [686, 80], [687, 81], [688, 82], [689, 83], [690, 84], [691, 85], [692, 86], [693, 87], [694, 88], [694, 89], [695, 90], [696, 91], [696, 92], [697, 93], [697, 94], [698, 95], [698, 96], [698, 97], [698, 98], [698, 99], [698, 100], [698, 101], [698, 102], [698, 103], [697, 104], [697, 105], [697, 106], [697, 107], [696, 108], [696, 109], [695, 110], [695, 111], [695, 112], [695, 113], [695, 114], [694, 115], [694, 116], [694, 117], [694, 118], [694, 119], [694, 120], [693, 121], [693, 122], [693, 123], [693, 124], [693, 125], [693, 126], [693, 127], [693, 128], [693, 129], [693, 130], [693, 131], [693, 132], [693, 133], [693, 134], [693, 135], [693, 136], [693, 137], [693, 138], [693, 139], [693, 140], [693, 141], [693, 142], [694, 143], [694, 144], [694, 145], [694, 146], [694, 147], [694, 148], [695, 149], [695, 150], [695, 151], [695, 152], [695, 153], [696, 154], [696, 155], [696, 156], [697, 157], [697, 158], [697, 159], [698, 160], [698, 161], [698, 162], [699, 163], [699, 164], [699, 165], [700, 166], [700, 167], [701, 168], [701, 169], [702, 170], [702, 171], [702, 172], [703, 173], [703, 174], [704, 175], [704, 176], [705, 177], [706, 178], [706, 179], [707, 180], [708, 181], [709, 182], [709, 183], [710, 184], [711, 185], [712, 186], [712, 187], [713, 188], [714, 189], [715, 190], [715, 191], [716, 192], [716, 193], [717, 194], [718, 195], [718, 196], [719, 197], [719, 198], [720, 199], [720, 200], [721, 201], [722, 202], [722, 203], [723, 204], [723, 205], [724, 206], [724, 207], [724, 208], [725, 209], [725, 210], [726, 211], [726, 212], [726, 213], [727, 214], [727, 215], [727, 216], [728, 217], [728, 218], [728, 219], [728, 220], [728, 221], [729, 222], [729, 223], [729, 224], [729, 225], [729, 226], [729, 227], [729, 228], [729, 229], [729, 230], [729, 231], [729, 232], [729, 233], [729, 234], [729, 235], [729, 236], [729, 237], [729, 238], [729, 239], [729, 240], [729, 241], [729, 242], [729, 243], [729, 244], [729, 245], [728, 246], [728, 247], [728, 248], [727, 249], [727, 250], [727, 251], [727, 252], [726, 253], [726, 254], [725, 255], [725, 256], [724, 257], [723, 258], [723, 259], [722, 260], [722, 261], [721, 262], [720, 263], [719, 264], [719, 265], [718, 266], [717, 267], [716, 268], [716, 269], [715, 270], [714, 271], [713, 272], [712, 273], [711, 274], [710, 275], [709, 276], [708, 277], [707, 278], [706, 279], [705, 280], [704, 281], [703, 282], [702, 283], [701, 284], [700, 285], [699, 286], [698, 287], [697, 288], [696, 289], [695, 290], [694, 291], [693, 292], [692, 293], [691, 294], [690, 295], [689, 296], [688, 297], [687, 298], [686, 299], [685, 300], [684, 301], [683, 302], [682, 303], [681, 304], [680, 305], [679, 306], [678, 307], [677, 308], [676, 309], [675, 310], [674, 311], [674, 312], [673, 313], [673, 314], [672, 315], [672, 316], [671, 317], [671, 318], [671, 319], [670, 320], [670, 321], [670, 322], [669, 323], [669, 324], [669, 325], [668, 326], [668, 327], [668, 328], [668, 329], [668, 330], [668, 331], [668, 332], [668, 333], [668, 334], [667, 335], [667, 336], [667, 337], [667, 338], [667, 339], [668, 340], [668, 341], [668, 342], [668, 343], [668, 344], [668, 345], [668, 346], [669, 347], [669, 348], [669, 349], [670, 350], [670, 351], [670, 352], [671, 353], [671, 354], [671, 355], [672, 356], [672, 357], [673, 358], [673, 359], [674, 360], [674, 361], [675, 362], [676, 363], [676, 364], [677, 365], [678, 366], [679, 367], [680, 367], [681, 368], [682, 369], [683, 370], [684, 370], [685, 371], [686, 372], [687, 372], [688, 373], [689, 374], [690, 374], [691, 375], [692, 376], [693, 377], [694, 377], [695, 378], [696, 379], [697, 379], [698, 380], [699, 381], [700, 381], [701, 382], [702, 383], [703, 384], [704, 384], [705, 385], [706, 386], [707, 386], [708, 387], [709, 388], [710, 388], [711, 389], [712, 390], [713, 391], [714, 391], [715, 392], [716, 393], [717, 393], [718, 394], [719, 395], [720, 395], [721, 396], [722, 397], [723, 398], [724, 399], [725, 400], [726, 401], [727, 402], [728, 403], [728, 404], [729, 405], [730, 406], [730, 407], [731, 408], [731, 409], [732, 410], [733, 411], [733, 412], [734, 413], [734, 414], [734, 415], [735, 416], [735, 417], [735, 418], [735, 419], [735, 420], [736, 421], [736, 422], [736, 423], [736, 424], [736, 425], [736, 426], [736, 427], [736, 428], [736, 429], [736, 430], [736, 431], [736, 432], [736, 433], [736, 434], [736, 435], [736, 436], [736, 437], [736, 438], [736, 439], [736, 440], [736, 441], [736, 442], [736, 443], [736, 444], [736, 445], [736, 446], [736, 447], [736, 448], [736, 449], [736, 450], [736, 451], [736, 452], [736, 453], [736, 454], [736, 455], [736, 456], [736, 457], [736, 458], [736, 459], [736, 460], [736, 461], [736, 462], [736, 463], [736, 464], [737, 465], [737, 466], [737, 467], [737, 468], [737, 469], [737, 470], [737, 471], [737, 472], [737, 473], [737, 474], [736, 475], [736, 476], [736, 477], [736, 478], [736, 479], [736, 480], [736, 481], [736, 482], [736, 483], [735, 484], [735, 485], [735, 486], [735, 487], [735, 488], [735, 489], [734, 490], [734, 491], [734, 492], [734, 493], [734, 494], [733, 495], [733, 496], [733, 497], [733, 498], [732, 499], [732, 500], [732, 501], [731, 502], [731, 503], [731, 504], [730, 505], [730, 506], [729, 507], [729, 508], [728, 509], [728, 510], [727, 511], [727, 512], [726, 513], [726, 514], [725, 515], [724, 516], [724, 517], [723, 518], [722, 519], [722, 520], [721, 521], [720, 522], [720, 523], [719, 524], [718, 525], [717, 526], [716, 527], [715, 528], [715, 529], [714, 530], [713, 530], [712, 531], [711, 532], [710, 533], [709, 534], [708, 534], [707, 535], [706, 536], [705, 536], [704, 537], [703, 538], [702, 538], [701, 539], [700, 539], [699, 540], [698, 541], [697, 541], [696, 541], [695, 542], [694, 542], [693, 543], [692, 543], [691, 543], [690, 544], [689, 544], [688, 544], [687, 545], [686, 545], [685, 545], [684, 545], [683, 546], [682, 546], [681, 546], [680, 546], [679, 546], [678, 546], [677, 546], [676, 546], [675, 546], [674, 546], [673, 546], [672, 546], [671, 546], [670, 546], [669, 546], [668, 546], [667, 546], [666, 546], [665, 546], [664, 546], [663, 546], [662, 545], [661, 545], [660, 545], [659, 545], [658, 544], [657, 544], [656, 544], [655, 544], [654, 543], [653, 543], [652, 543], [651, 542], [650, 542], [649, 542], [648, 541], [647, 541], [646, 540], [645, 540], [644, 539], [643, 539], [642, 538], [641, 538], [640, 537], [639, 537], [638, 536], [637, 536], [636, 535], [635, 534], [634, 534], [633, 533], [632, 532], [631, 532], [630, 531], [629, 530], [628, 529], [627, 529], [626, 528], [625, 527], [624, 527], [623, 526], [622, 525], [621, 524], [620, 524], [619, 523], [618, 522], [617, 522], [616, 521], [615, 520], [614, 519], [613, 519], [612, 518], [611, 517], [610, 517], [609, 516], [608, 515], [607, 514], [606, 514], [605, 513], [604, 512], [603, 512], [602, 511], [601, 510], [600, 509], [599, 509], [598, 508], [597, 508], [596, 507], [595, 507], [594, 506], [593, 506], [592, 506], [591, 506], [590, 506], [589, 507], [588, 507], [587, 507], [586, 507], [585, 508], [584, 509], [583, 510], [582, 511], [581, 512], [580, 513], [580, 514], [579, 515], [579, 516], [578, 517], [578, 518], [578, 519], [577, 520], [577, 521], [577, 522], [576, 523], [576, 524], [576, 525], [576, 526], [576, 527], [576, 528], [575, 529], [575, 530], [575, 531], [574, 532], [574, 533], [574, 534], [574, 535], [573, 536], [573, 537], [573, 538], [573, 539], [572, 540], [572, 541], [572, 542], [572, 543], [571, 544], [571, 545], [571, 546], [571, 547], [570, 548], [570, 549], [570, 550], [570, 551], [569, 552], [569, 553], [569, 554], [568, 555], [568, 556], [568, 557], [568, 558], [568, 559], [567, 560], [567, 561], [567, 562], [567, 563], [566, 564], [566, 565], [566, 566], [566, 567], [565, 568], [565, 569], [565, 570], [564, 571], [564, 572], [564, 573], [564, 574], [563, 575], [563, 576], [563, 577], [563, 578], [563, 579], [562, 580], [562, 581], [562, 582], [561, 583], [561, 584], [561, 585], [561, 586], [560, 587], [560, 588], [559, 589], [559, 590], [558, 591], [557, 592], [557, 593], [556, 594], [555, 595], [555, 596], [554, 597], [553, 598], [552, 599], [551, 600], [550, 601], [549, 602], [548, 603], [547, 603], [546, 604], [545, 604], [544, 605], [543, 606], [542, 606], [541, 607], [540, 607], [539, 608], [538, 608], [537, 608], [536, 609], [535, 609], [534, 609], [533, 609], [532, 609], [531, 609], [530, 609], [529, 609], [528, 609], [527, 609], [526, 609], [525, 609], [524, 609], [523, 609], [522, 609], [521, 609], [520, 609], [519, 609], [518, 609], [517, 609], [516, 609], [515, 609], [514, 609], [513, 609], [512, 609], [511, 609], [510, 609], [509, 609], [508, 609], [507, 609], [506, 609], [505, 609], [504, 609], [503, 609], [502, 609], [501, 609], [500, 609], [499, 609], [498, 609], [497, 609], [496, 609], [495, 609], [494, 609], [493, 609], [492, 609], [491, 609], [490, 609], [489, 609], [488, 609], [487, 609], [486, 609], [485, 609], [484, 609], [483, 609], [482, 609], [481, 609], [480, 609], [479, 609], [478, 609], [477, 609], [476, 609], [475, 609], [474, 609], [473, 609], [472, 609], [471, 609], [470, 609], [469, 609], [468, 609], [467, 609], [466, 609], [465, 609], [464, 609], [463, 609], [462, 609], [461, 609], [460, 609], [459, 609], [458, 609], [457, 609], [456, 609], [455, 609], [454, 609], [453, 609], [452, 609], [451, 609], [450, 609], [449, 609], [448, 609], [447, 609], [446, 609], [445, 609], [444, 609], [443, 609], [442, 609], [441, 609], [440, 609], [439, 609], [438, 609], [437, 609], [436, 609], [435, 609], [434, 609], [433, 609], [432, 609], [431, 609], [430, 609], [429, 609], [428, 609], [427, 609], [426, 609], [425, 609], [424, 609], [423, 609], [422, 609], [421, 609], [420, 609], [419, 609], [418, 609], [417, 609], [416, 609], [415, 609], [414, 609], [413, 609], [412, 609], [411, 609], [410, 609], [409, 609], [408, 609], [407, 609], [406, 609], [405, 609], [404, 609], [403, 609], [402, 609], [401, 609], [400, 609], [399, 609], [398, 609], [397, 609], [396, 609], [395, 609], [394, 609], [393, 609], [392, 609], [391, 609], [390, 609], [389, 609], [388, 609], [387, 609], [386, 609], [385, 609], [384, 609], [383, 609], [382, 609], [381, 609], [380, 609], [379, 609], [378, 609], [377, 609], [376, 609], [375, 609], [374, 609], [373, 609], [372, 609], [371, 609], [370, 609], [369, 609], [368, 609], [367, 609], [366, 609], [365, 609], [364, 609], [363, 609], [362, 609], [361, 609], [360, 609], [359, 609], [358, 609], [357, 609], [356, 609], [355, 609], [354, 609], [353, 609], [352, 609], [351, 609], [350, 609], [349, 609], [348, 609], [347, 609], [346, 609], [345, 609], [344, 609], [343, 609], [342, 609], [341, 609], [340, 609], [339, 609], [338, 609], [337, 609], [336, 609], [335, 609], [334, 609], [333, 609], [332, 609], [331, 609], [330, 609], [329, 609], [328, 609], [327, 609], [326, 609], [325, 609], [324, 609], [323, 609], [322, 609], [321, 609], [320, 609], [319, 609], [318, 609], [317, 609], [316, 609], [315, 609], [314, 609], [313, 609], [312, 609], [311, 609], [310, 609], [309, 609], [308, 609], [307, 609], [306, 609], [305, 609], [304, 609], [303, 609], [302, 609], [301, 609], [300, 609]]
medium_route = [[445, 49], [435, 48], [425, 48], [415, 48], [405, 48], [395, 48], [385, 48], [375, 48], [365, 48], [355, 48], [345, 48], [335, 48], [325, 48], [315, 48], [305, 48], [295, 48], [285, 48], [275, 48], [265, 48], [255, 48], [245, 48], [235, 48], [225, 48], [215, 48], [205, 48], [195, 48], [185, 48], [175, 48], [169, 56], [169, 66], [169, 76], [169, 86], [169, 96], [168, 106], [168, 116], [168, 126], [168, 136], [168, 146], [168, 156], [168, 166], [168, 176], [169, 186], [172, 196], [177, 206], [186, 215], [196, 222], [204, 232], [207, 242], [209, 252], [209, 262], [209, 272], [209, 282], [209, 292], [209, 302], [209, 312], [207, 322], [202, 332], [195, 342], [185, 350], [175, 355], [165, 358], [155, 360], [145, 362], [135, 364], [125, 365], [115, 367], [105, 369], [95, 371], [85, 373], [75, 377], [65, 386], [58, 396], [55, 406], [52, 416], [52, 426], [51, 436], [52, 446], [52, 456], [52, 466], [52, 476], [52, 486], [54, 496], [60, 506], [69, 513], [79, 514], [89, 513], [99, 510], [109, 505], [119, 500], [129, 495], [139, 490], [149, 485], [159, 480], [169, 477], [179, 474], [189, 473], [199, 471], [209, 471], [219, 471], [229, 471], [237, 464], [237, 454], [237, 444], [237, 434], [237, 424], [237, 414], [244, 406], [254, 406], [264, 406], [274, 406], [284, 406], [294, 406], [304, 406], [314, 406], [324, 406], [333, 410], [334, 420], [334, 430], [334, 440], [334, 450], [334, 460], [334, 470], [334, 480], [334, 490], [334, 500], [335, 510], [344, 515], [354, 515], [364, 515], [374, 515], [384, 515], [394, 515], [401, 507], [401, 497], [401, 487], [401, 477], [401, 467], [401, 457], [401, 447], [401, 437], [401, 427], [401, 417], [401, 407], [401, 397], [401, 387], [399, 377], [395, 367], [388, 357], [379, 347], [371, 337], [362, 327], [354, 317], [345, 307], [335, 298], [325, 293], [315, 288], [305, 283], [295, 275], [286, 265], [282, 255], [280, 245], [280, 235], [279, 225], [279, 215], [279, 205], [279, 195], [279, 185], [279, 175], [279, 165], [279, 155], [279, 145], [279, 135], [279, 125], [279, 115], [287, 108], [297, 107], [307, 107], [317, 107], [327, 107], [337, 107], [347, 107], [357, 109], [362, 118], [362, 128], [362, 138], [364, 148], [374, 151], [384, 151], [394, 151], [404, 151], [414, 151], [424, 151], [434, 151], [444, 151], [454, 151], [464, 151], [474, 151], [484, 151], [494, 151], [504, 151], [514, 151], [524, 150], [534, 145], [543, 136], [549, 126], [554, 116], [562, 106], [572, 99], [582, 96], [592, 95], [602, 95], [612, 95], [622, 96], [632, 96], [642, 96], [652, 96], [662, 96], [672, 96], [682, 96], [692, 96], [702, 96], [711, 102], [711, 112], [712, 122], [712, 132], [712, 142], [712, 152], [711, 162], [701, 165], [691, 165], [681, 165], [671, 165], [661, 167], [651, 171], [641, 179], [633, 189], [626, 199], [619, 209], [613, 219], [606, 229], [596, 238], [586, 244], [576, 249], [566, 254], [556, 259], [546, 264], [536, 269], [526, 274], [516, 279], [506, 284], [496, 290], [488, 300], [485, 310], [485, 320], [485, 330], [485, 340], [485, 350], [485, 360], [489, 370], [499, 371], [509, 371], [519, 370], [529, 370], [539, 373], [542, 383], [542, 393], [542, 403], [542, 413], [543, 423], [548, 433], [556, 443], [566, 453], [576, 463], [584, 473], [590, 483], [593, 493], [594, 503], [594, 513], [594, 523], [594, 533], [593, 543], [593, 553], [593, 563], [593, 573], [590, 583], [580, 585], [570, 585], [560, 585], [550, 586], [540, 586], [530, 586], [520, 586], [510, 586], [500, 586], [490, 586], [480, 586], [470, 586], [460, 586], [450, 587], [440, 587], [430, 587], [420, 587], [410, 587], [400, 587], [390, 587], [380, 587], [370, 587], [360, 587], [350, 587], [340, 588]]
jog_Yplus = bytearray([2,7,119,3]) # 2,7,W,3
jog_Yminus = bytearray([2,7,115,3])
jog_Xplus = bytearray([2,7,100,3]) # STX, JOG_TYPE, D, ETX
jog_Xminus = bytearray([2,7,97,3])
#route = bytearray([2,5,3,0,100,3,46,3,46,40,3])
#route_test = bytearray([2,5,9,0,125,3,100,3,70,3,44,3,44,35,44,77,63,102,63,138,2,134,3])
route = []
start = bytearray([2,6,10,3])
stop = bytearray([2,6,11,3])
home = bytearray([2,6,12,3])
reset = bytearray([2,6,13,3])
fail = bytearray([2,6,14,3])


# Serial object
ser = serial.Serial()
ser.baudrate = 115200
ser.port = 'COM5'
ser.open()
sleep(1)

test_packet=[]
YellowLower=(100,50,50)
YellowUpper=(130,255,255) 
greenLower = (35, 43, 46)#(50, 43, 46)
greenUpper = (77, 255, 255)#(90, 255, 255)
count=0

def main():    
    
    while True:
        serial_read()
        key = input(": ")
    
        if (key == "R"):
            route = medium_route
            route_indexed = [route[i] for i in range(len(route)) if i%2 == 0]
            length = len(route_indexed)
            packet_to_send = [2,5,(length & 0xff),(length >> 8)&0xff]
            for i in range(length):
                for j in range(2):
                    packet_to_send.append(int(route_indexed[i][j]/3))
            packet_to_send.append(3)
            #print(packet_to_send)
            ser.write(bytearray(packet_to_send))
            # route_to_send = np.array(medium_route_indexed).flatten()
            # route_to_send = route_to_send / 2.5
            # length = len(route_to_send)
            # np.insert(route_to_send, 0, 2)
            # np.insert(route_to_send, 1, 5)
            # bin_length = bin(length)
            # print(bin_length)
            # #np.insert(route_to_send, 2, )
            # #np.insert(route_to_send, 3, )
            # np.insert(route_to_send, length , 3)
            # print(route_to_send)
            # route_to_send = bytearray(route_to_send)
            # print(route_to_send)
            #packet = 
            #ser.write(route)
            sleep(1)
            serial_read()
            continue
            
        if (key == "I"):
            x,y,t = image_processor()
            plot(x,y,t)
            serial_read()
            sleep(0.1)
            continue
                   
        if (key == "a"):
            ser.write(jog_Xminus)
            sleep(0.1)
            continue

        if (key == "d"):
            ser.write(jog_Xplus)
            sleep(0.1)
            continue
        
        if (key == "w"):
            ser.write(jog_Yplus)
            sleep(0.1)
            continue

        if (key == "s"):
            ser.write(jog_Yminus)
            sleep(0.1)
            continue
            
        if (key == "H"):
            ser.write(home)
            sleep(1)
            continue
    
        elif (input(": ") == "E"):
            exit()
            break
            

def exit():
    cv2.destroyAllWindows()
    return sys.exit()
    
def board_detection():
    if len(cnts2) > 3 and cv2.contourArea(cnts2[3])>75:     
        x1,y1,w1,h1 =cv2.boundingRect(cnts2[0])
        x2,y2,w2,h2 =cv2.boundingRect(cnts2[1])
        x3,y3,w3,h3 =cv2.boundingRect(cnts2[2])
        x4,y4,w4,h4 =cv2.boundingRect(cnts2[3])
        
        XCORS=[x1,x2,x3,x4]
        YCORS=[y1,y2,y3,y4]
        sorted(XCORS,reverse=True)
        sorted(YCORS,reverse=True)
        Width=XCORS[0]-XCORS[3]
        Height=YCORS[0]-YCORS[3]
        
        cv2.rectangle(frame,(XCORS[3],YCORS[3]),(XCORS[3]+Width,YCORS[3]+Height),(255,0,0),2)
        # cv2.rectangle(frame,(x2,y2),(x2+w2,y2+h2),(255,0,0),2)
        # cv2.rectangle(frame,(x3,y3),(x3+w3,y3+h3),(255,0,0),2)
        # cv2.rectangle(frame,(x4,y4),(x4+w4,y4+h4),(255,0,0),2)
        # roi=frame[YCORS[3]:YCORS[3]+Height,XCORS[3]:XCORS[3]+Width]
        # boardimage = cv2.imshow("roi",roi)
        # return boardimage
    else:
        print("4 corner not found")
        return None
    
def image_processor():
    # Image processor initialisation
    xcor = 0
    ycor = 0
    vid = cv2.VideoCapture(1,cv2.CAP_DSHOW)
    count2=0
    x_tracking = []
    y_tracking = []
    times = []
    record = 0
    # Image processor loop
    while True:
        test_packet=[]
        ret,frame=vid.read()
        frame=cv2.resize(frame,(765,635))
        cv2.imshow("frame",frame)
        blurred = cv2.GaussianBlur(frame, (5, 5), 0)
        hsv = cv2.cvtColor(blurred, cv2.COLOR_BGR2HSV)  
        # construct a mask for the color green
        maskboard=cv2.inRange(hsv,YellowLower,YellowUpper)
        mask = cv2.inRange(hsv, greenLower, greenUpper)
        kernel = np.ones((5,5),np.uint8)
        maskboard = cv2.morphologyEx(maskboard.copy(), cv2.MORPH_OPEN, kernel)
        maskboard2 =cv2.dilate(maskboard,kernel,iterations = 1)

       
        cnts2,hierarchy = cv2.findContours(maskboard2.copy(),cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)
        
        new_contours=[]
        
        for contour in cnts2:
            approx=cv2.approxPolyDP(contour, 0.01 * cv2.arcLength(contour, True), True)
            area=cv2.contourArea(contour)
            if area >=50 :
                new_contours.append(contour)

        new_contours = sorted(new_contours, key=lambda x: cv2.contourArea(x), reverse=True)
        if len(new_contours) >= 4:
            new_contours = new_contours[:4]
            sorted_contours = []

            for i in range(4):
                x, y, w, h = cv2.boundingRect(new_contours[i])
                sorted_contours.append((x + w / 2, y + h / 2))
            sorted_contours = sorted(sorted_contours, key=lambda x: x[1])
            if sorted_contours[0][0] > sorted_contours[1][0]:
                sorted_contours[0], sorted_contours[1] = sorted_contours[1], sorted_contours[0]
            if sorted_contours[2][0] < sorted_contours[3][0]:
                sorted_contours[2], sorted_contours[3] = sorted_contours[3], sorted_contours[2]
            src_pts = np.array(sorted_contours, np.float32)
            dst_pts = np.array([[0, 0], [765, 0], [765, 635], [0, 635]], np.float32)
            M = cv2.getPerspectiveTransform(src_pts, dst_pts)
            # contour = new_contours[i]
            # rect = cv2.minAreaRect(contour)
            # box = cv2.boxPoints(rect)
            # box = np.int0(box)
            # cv2.drawContours(frame, [box], 0, (255, 0, 255), 2)
            result = cv2.warpPerspective(frame, M, (765,635))
            result2 = cv2.resize(result,(765,725))
            blurred2 = cv2.GaussianBlur(result, (5, 5), 0)
            hsv2= cv2.cvtColor(blurred2, cv2.COLOR_BGR2HSV)
            mask2 = cv2.inRange(hsv2, greenLower, greenUpper)
            cnts, hierarchy = cv2.findContours(mask2.copy(), cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)
            
            count=0
            centers=[]
            arrow=0
            arrowcount=0
            a=0
            b=0
            check=0
            if len(cnts) > 0:
                c = max(cnts, key=cv2.contourArea)
                if cv2.contourArea(c) > 15 and count<100:  # contour area was 25
                    count=0
                    x,y,w,h =cv2.boundingRect(c)
                    cv2.rectangle(result,(x,y),(x+w,y+h),(255,255,0),2)
                    center=(int((x+w/2)/3),int((y+h/2)/3))
                    xcor=int((x+w/2)/3)
                    ycor=int((y+h/2)/3)
                    #print(center)
                    #print("X: ", xcor, "Y: ", ycor)
                    cv2.circle(result, center, 5, (0, 0, 255), -1)
                    centers.append(center)
                    arrowcount=arrowcount+1
                    minute=datetime.now().strftime("%M") # PROBLEM HERE - YOU HAD USED A KEYWORD MIN
                    minute=int(minute)
                    sec=datetime.now().strftime("%S")
                    sec=int(sec)
                    microsec=datetime.now().strftime("%f")
                    microsec1=int(str(microsec)[:2])
                    microsec2=int(str(microsec)[2:4])
                    microsec3=int(str(microsec)[4:])
                    test_packet=([2,4,xcor,ycor,minute,sec,microsec1,microsec2,microsec3,3])
                elif cv2.contourArea(c) < 5 :
                    center="ball disappeared"
                    test_packet=[]		
            cv2.imshow('Image ', result)
            #cv2.imshow("mask",mask2)
            #cv2.imshow("mask2",maskboard2)
            #cv2.imshow("hsv",hsv)
        #cv2.imwrite("norman_test.png", result)
        
        
        key = cv2.waitKey(1) & 0xFF
        if len(test_packet) > 9:
            count2=0
            #print(test_packet)
            serialout=bytearray(test_packet)
            ser.write(serialout)
            
        if len(test_packet)<9:
            count2 += 1
            
        # if the 'S' key is pressed, stop the loop
        if key == ord("S"):
            ser.write(start)
            record = 1
            
        if (record == 1): # used to log/ plot the response
            x_tracking.append(xcor)
            y_tracking.append(ycor)
            time = float((sec * 1000) + (float(microsec) / 1000))
            times.append(time) # in ms
            
        if count2 > 1999:
            print("FAIL - ball dropped")
            return x_tracking, y_tracking, times
            
        # if the 'E' key is pressed, stop the loop
        if key == ord("E"):
            ser.write(stop)
            return x_tracking, y_tracking, times
        
        serial_read()
        #sleep(0.1)
            

def serial_read():
    while (ser.in_waiting > 0):
        print(ser.read_until().decode("utf-8"), end = '') 
    return
    
def plot(x, y, t):
    X = np.array(x)
    Y = np.array(y)
    T = np.array(t)
    T = T - T[0] # scale the start time to be zero
    fig, ax = plt.subplots(2)
    ax[0].plot(T,X, color = 'red', linewidth = 1.0)
    ax[0].set_title("X Axis")
    ax[0].set_xlabel("Time [ms]")
    ax[0].set_ylabel("PositionS")
    ax[1].plot(T,Y, color = 'blue', linewidth = 1.0)
    ax[1].set_title("Y Axis")
    ax[1].set_xlabel("Time [ms]")
    ax[1].set_ylabel("Position")
    fig.tight_layout()
    plt.show()
    return

    

if __name__ == "__main__":
    main()
    
